
<input hidden="hidden" value="#(model.id??)" name="model.id" id="model_id"></input>
<div class="row">

	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">类别名称</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称" readonly="readonly"
					value="#(model.cate_tmp??)">
			</div>
		</div>
	</div>
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">计划员</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.plan_tmp??)" >
			</div>
		</div>
	</div>


</div>


<div class="row">

	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">执行状态</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.execu_status??)"">
			</div>
		</div>
	</div>
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">紧急状态</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.urgent_status??)" >
			</div>
		</div>
	</div>


</div>

<div class="row">

	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">订单日期</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.order_date??)">
			</div>
		</div>
	</div>
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">交货日期</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.delivery_date??)" >
			</div>
		</div>
	</div>


</div>

<div class="row">

	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">工作订单号</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.work_order_no??)">
			</div>
		</div>
	</div>
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">送货单号</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.delivery_no??)" >
			</div>
		</div>
	</div>


</div>

<div class="row">

	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">商品名称</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.commodity_name??)"x>
			</div>
		</div>
	</div>
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">商品规格</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.commodity_spec??)" >
			</div>
		</div>
	</div>


</div>


<div class="row">

	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">总图号</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.map_no??)" x>
			</div>
		</div>
	</div>
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">技术条件</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.technology??)" x>
			</div>
		</div>
	</div>


</div>

<div class="row">

	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">质量等级</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.machining_require??)" >
			</div>
		</div>
	</div>
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">数量</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="#(model.quantity??)">
			</div>
		</div>
	</div>


</div>


<div class="row">
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">单位</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="类别名称"  readonly="readonly"
					value="" >
			</div>
		</div>
	</div>
	
	<div class="col-md-6">
		<div class="form-group">
			<label class="col-sm-3 control-label">采购日期</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="采购日期"   data-type='datepicker'
					value=""  name="purchaseDate">
			</div>
		</div>
	</div>

</div>



<div class="row">
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">单件</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="单件"  name="purchaseSingleWeight"
					value="" >
			</div>
		</div>
	</div>
	
	<div class="col-md-6">
		<div class="form-group">
			<label class="col-sm-3 control-label">总重</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="总重"  name="purchaseWeight"
					value="" >
			</div>
		</div>
	</div>
</div>


<div class="row">
	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">单价</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="单价"  name="purchaseCost"
					value="" >
			</div>
		</div>
	</div>
	
	<div class="col-md-6">
		<div class="form-group">
			<label class="col-sm-3 control-label">总金额</label>

			<div class="col-sm-9">
				<input type="text" class="form-control" placeholder="总金额"   name="purchaseAccount"
					value="" >
			</div>
		</div>
	</div>

</div>


<div class="row">


	<div class="col-md-6">

		<div class="form-group">
			<label class="col-sm-3 control-label">供应商</label>

			<div class="col-sm-9">
					<ul class="list-group" id="supp_list">
					
					</ul>
				<input type="button" class="btn" placeholder=""
					value="选择供应商" name="model.name" onclick="showChooesSupplier()">
			</div>
		</div>
	</div>


</div>
<script type="text/javascript">
<!--

//-->

function submit(){
	var modeId= $("#model_id").val();
	var suppId=[];
	var lis = $("#supp_list").children("li")
	if(lis.length == 0){
		alert("没有选择供应商");
		return ;
	}
	for(var i= 0; i < lis.length ;i ++){
		console.debug(" sup id = "+lis[i].value);
		suppId[i] = lis[i].value;
	}
	/**/
	$.ajax({
		   type: "POST",
		   url: "/fy/admin/biz/commission/savePurchase",
		   data:{id:modeId,supplier:suppId},
		   success: function(ret){
		     alert( "Data Saved: " +ret.msg );
		   },
		   error:function (XMLHttpRequest, textStatus, errorThrown) {
			    // 通常 textStatus 和 errorThrown 之中
			    // 只有一个会包含信息
			    this; // 调用本次AJAX请求时传递的options参数
			}
		});
	
	
}

function romveSup(bt){
		$(bt).parent().remove();
	
}



	function showChooesSupplier(){
		
		$('#myModel').modal("show");
		getSupplierFromServer(1);	
	  	}

	function onselectSupplier(){
		
		var list = $("#supp_list");
	  	var inp = $("input[name='selectSupplier']:checked");
	  	console.info(inp);
	  	/*
		 var a = $("input[name='selectSupplier']:checked").val();
		 if(a!=null){
			 var idName = 	a.split("_");
	  		 personId.val(idName[0]);
	  		 personName.val(idName[1]);
	  	}else{
		alert("没有选择人员");
		return;
	    }
	    */
		for(var i = 0; i<inp.length;i++){
	  			var v= inp[i].value
				console.info(v);
	  			var id_name = v.split("_");
	  			var li = '<li class="list-group-item" value='+id_name[0]+'>'+id_name[1]
					  +'<button type="button" onclick="romveSup(this)" class="close" data-dismiss="item" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+
					  '</li>';
	  			list.append(li);
	  		}
		 console.debug(inp);
		$('#myModel').modal("hide");
	  	}


	function getSupplierFromServer(pageNumer){
		
		$.get("/fy/admin/base/supplier/searchSupplierJson", { keyWord: $("#pmodelKeyWord").val(), p : pageNumer},
			  function(data){
				plist = 	data.list;
				var	ptbody = $("#ptbody");
				ptbody.empty();
			for(x in plist){
					console.debug(plist[x].name);
					
					var tr='<tr><td class="text-center"><input type="checkbox" name="selectSupplier" value="'+plist[x].id+'_'+plist[x].name+'"></td>'+
					'<td>'+plist[x].name+'</td>'+
					'<td>'+plist[x].address+'</td>'+
					'<td>'+plist[x].phone+'</td></tr>';
					ptbody.append(tr);
				}

			
			var pageUl =$("#pageUl");
			pageUl.empty();
			if(data.totalPage < 2 ){
				return;
			}
			else{
				
				if(data.firstPage){
					var li = '<li class="disabled"  ><a href="#" aria-label="Previous"> <span aria-hidden="true">&laquo;</span> </a></li>'
						pageUl.append(li);
				}else{
					var li = '<li onclick="getSupplierFromServer('+ (data.pageNumber -1 )+')"><a href="#" aria-label="Previous"> <span aria-hidden="true">&laquo;</span> </a></li>'
						pageUl.append(li);
				}

				if(data.totalPage>5){
						for(var i = 1;i<6;i++){
							if(data.pageNumber==i){
									var li = '<li class="active"><a href="#">'+i+'</a></li>'
									pageUl.append(li);
								}
								else{
									var li = '<li onclick="getSupplierFromServer('+ i +')"><a href="#">'+i+'</a></li>'
									pageUl.append(li);
								}
						}	
				}else{
					for(var i = 1;i<(data.totalPage+1);i++){
						if(data.pageNumber==i){
								var li = '<li class="active"><a href="#">'+i+'</a></li>'
								pageUl.append(li);
							}
							else{
								var li = '<li onclick="getSupplierFromServer('+ i +')"><a href="#">'+i+'</a></li>'
								pageUl.append(li);
							}
					}	

				}
				if(data.lastPage){
					var  li = '<li class="disabled" ><a href="#" aria-label="Next"> <span aria-hidden="true">&raquo;</span></a></li>'
						pageUl.append(li);
				}else{
					var  li = '<li onclick="getSupplierFromServer('+ (data.pageNumber -1 )+')" ><a href="#" aria-label="Next"> <span aria-hidden="true">&raquo;</span></a></li>'
					pageUl.append(li);
				}

				
				}
			  },'json');
	  	}
</script>
#include("searchSupplier.html")



	