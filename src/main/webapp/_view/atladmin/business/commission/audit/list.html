
#@myLayout() #define main()


<div class="row">
	<div class="col-xs-12">
		<div class="box">
			<div class="box-header">
				<h3 class="box-title">采购审核</h3>
				<button  class="btn btn-primary" id="bt_show_audit">审核</button>
				<button id="editCost" class="btn btn-primary"  data-action="/fy/admin/biz/commission/execute/edit" >修改价格 </button><!-- order_id=(x.order_id) -->
			
				<script type="text/javascript">
					$(function(){
						$("#bt_show_audit").click(function(){
							var selectIds = $("input[name=selectId]:checked");
							if(selectIds==null||selectIds.length ==0){
								alert("没有选择订单");
								return;
							}
							$("#auditModel").modal("show");
						});
						
						
				  		$("#editCost").click(function(){
				  			var outId = $('input[name =selectId]:checked');
				  			if(outId.length!=1){
				  				alert("只能选择一条订单修改");
				  				return;
				  			}
				  			var order_id = outId.data('orderid');
				  			var action = $(this).data('action');
				  			var input='<input name="order_id" value="'+order_id+'" >'
				  			var path='<input name="path" value="/fy/admin/biz/commission/audit" >'
				  			var form  = $("<form></form>")
					          form.attr('action',action)
					          form.attr('method','post')
				  			form.append(input);
				  			form.append(path);
				  		   form.appendTo("body")
				  	        form.css('display','none')
				  			form.submit();
				  		});
						
					});
				</script>
				<div class="box-tools">
					<form action=""  class="form-inline">
						 <div class="form-group  input-group-sm">
						 	    <label for="pageSize">显示</label>
						 	   	<select id="pageSize" class="form-control" name="pageSize" >
						 	   			<option  value="10">10</option>
						 	   			<option  value="20" #if(pageSize == 20) selected="selected" #end >20</option>
						 	   			<option  value="30" #if(pageSize == 30) selected="selected" #end >30</option>
						 	   			<option  value="50" #if(pageSize == 50) selected="selected" #end >50</option>
						 	   			<option  value="100" #if(pageSize == 1000) selected="selected" #end >100</option>
						 	   	</select>
						 </div>
						 <div class="form-group  input-group-sm">
						    <label for="condition">条件</label>
							   
							    <select id="condition" class="form-control" name="condition"   onchange="onselectCondition()">
							    	<option #if(condition=="cate_tmp") selected="selected" #end value="cate_tmp">类别</option>
							    	<option #if(condition=="plan_tmp") selected="selected" #end value="plan_tmp">计划员</option>
							    	<option #if(condition=="map_tmp") selected="selected" #end value="map_tmp">总图号</option>
							    	<option #if(condition=="order_date") selected="selected" #end value="order_date">订单日期</option>
							    	<option #if(condition=="delivery_date") selected="selected" #end value="delivery_date">交货日期</option>
							    	<option #if(condition=="work_order_no") selected="selected" #end value="work_order_no" >工作订单号</option>
									<option #if(condition=="map_no") selected="selected" #end value="map_no">图号</option>
							    	<option #if(condition=="delay_warn") selected="selected" #end value="delay_warn">交货预警</option>
							    	<option #if(condition=="delay") selected="selected" #end value="delay">拖期</option>
							    </select>
							   
						  
						  </div>
						  
						 <div id="keyword_div" class="form-group  input-group-sm"  >
								<input id="keyword" type="text" name="keyWord" autocomplete="off" class="form-control"  value="#(keyWord)">
							
						  
						  </div>
						   
						  <div class="form-group  input-group-sm">
						  	<button type="submit" class="btn btn-default">
									<i class="fa fa-search"></i>
								</button>
						  </div>
						
  <script type="text/javascript">
	  function onselectCondition(){
	  		var val = $("#condition").val();
	  		var keyword_div = $("#keyword_div");
	  			keyword_div.empty();
	  			var input='<input id="keyword" type="text" name="keyWord" autocomplete="off" class="form-control"  >';
	  			keyword_div.append(input);
	  		if("order_date"==val||"delivery_date"==val){
	  			
	  			$("#keyword").datepicker({
	 	  		    	language:'zh-CN',
	 	  		      autoclose: true,
	 	  		      format:'yyyy-mm-dd',
	 	  		      todayBtn:'linked',
	 	  		      todayHighlight:true,
	 	  		       orientation:'bottom' 
	 	  		    });
	 	 	 	
	 	 		
	  		}else{
	  			
	  		}
	  }
						  	
</script>
					</form>
				</div>
			</div>
			<!-- /.box-header -->
			<div id= "div_table" class="box-body table-responsive no-padding" style="margin-bottom: 0px;">
	
					<table class="table table-bordered"  style="white-space:nowrap">
						<thead>
							<tr>
								<th style="">序号</th>		
								<th><input type="checkbox" id="selectAll">多选</th>
								<th>类别</th>
								<th>计划员</th>
								<th>执行状态</th>
								<th>紧急状态</th>
								<th>工作订单号</th>
								<th>送货单号</th>
								<th>图号</th>
								<th>名称</th>
								<th>总图号</th>
								<th>数量</th>
								<th>单位</th>
								<th>型号</th>
								<th>规格</th>
								<th>技术条件</th>
								<th>质量等级</th>
								<th>订单日期</th>
								<th>交货日期</th>
								
								<th>厂商编码</th>
								<th>厂商名称</th>
								<th>单价</th>
								<th>总价</th>
								
								<th>含税/未税</th>
								
								<th>单件</th>
								<th>总重</th>
								<th>采购交货日期</th>
							
								
								<th>审核状态</th>
								<th>审核时间</th>
								
							</tr>
						</thead>
					<form class="form-horizontal" id="myForm" action="" method="post">     
					
						<tbody>
							#for(x : modelPage.getList())
							<tr>
								<td>#(for.index+1)</td>
								<td> <input  type="checkbox" name = "selectId"  value="#(x.audit_id)"  data-orderid="#(x.id)"></td>
								
								<td>#(x.cate_tmp)</td>  
								<td>#(x.plan_tmp)</td>
								<td>#(x.execu_status)</td>
								<td>#(x.urgent_status)</td>
								<td>#(x.work_order_no)</td>
								<td>#(x.delivery_no)</td>
								<td  data-id="#(x.id)">
										#(x.map_no) 
								 </td>
								<td>#(x.commodity_name)</td>
								<td>#(x.total_map_no)</td>
								<td>#(x.quantity)</td>
								<td>#(x.unit_tmp)</td>	 
								<td>#(x.model_no)</td>
								<td>#(x.commodity_spec)</td>
								<td>#(x.technology)</td>
								<td>#(x.machining_require)</td>
								<td>#date(x.order_date,"yyyy-MM-dd")</td>
								<td>#date(x.delivery_date,"yyyy-MM-dd")</td>
							
								<td>#(x.supplier_no)</td> 
								
								<td>#(x.supplier_name)</td> 		
								<td>#(x.purchase_cost)</td> 
								<td>#(x.purchase_account)</td> 
								
								<td>#(x.is_has_tax)</td>
								
								
								<td>#(x.purchase_single_weight)</td>
								<td>#(x.purchase_weight)</td>
								<td>#(x.purchase_delivery_date)</td>
								
								
								<td>#(x.audit_status)</td>
								<td>#(x.audit_time)</td>
							
								
							</tr>
							#end
						</tbody>
						
					</form>
					</table>
			</div>
		
			<!-- /.box-body -->

			<div class="box-footer clearfix">
				#@myadminPaginate(modelPage.pageNumber, modelPage.totalPage,
				"/fy/admin/biz/commission/audit?p=")</div>
				
				<div style="position:fixed ; bottom:20px;width:50%;right: 20px" >
				<input id="ex6" type="text" data-slider-min="0"  data-slider-step="1" data-slider-value="0" style="width: 100%"/>  
			 <script type="text/javascript">
			 //data-slider-max="100"
				 $(function(){
					 var lenth= $("#div_table").get(0).scrollWidth -$("#div_table").width();
					var ex6 =  $("#ex6");
					ex6.slider({
						max:lenth
					});
					 $("#ex6").on("slide", function(slideEvt) {
						 var withSize = $("#div_table").width();
						 $("#div_table").scrollLeft(slideEvt.value);
					 	  
					 	
					 });
					 
					 var div_table=  $("#div_table");
					 div_table.scroll(function(){
 
						var scrollLeft =  $(this).scrollLeft();
						 console.info("scrollLeft : "+ scrollLeft);
						$("#ex6").slider('setValue', scrollLeft);
					 
					 });
				 });
			
			 </script>
			 </div>
				
				
		</div>
		<!-- /.box -->
	</div>
</div>

#include("auditModel.html")
<script type="text/javascript">

$(function(){
	$("#selectAll").click(function(){
		var isChecked =  $("#selectAll").is(":checked");
		if( isChecked ){
			$('input[name=selectId]').each(function() {
				//$(this).attr('checked', true);
				this.checked= true;
				});
		}else{
			$('input[name=selectId]').each(function() {
				//$(this).attr('checked', false);
				this.checked= false;
			});
		}
		console.info('this');
		
	});
	
	
});


 
    </script>

#end